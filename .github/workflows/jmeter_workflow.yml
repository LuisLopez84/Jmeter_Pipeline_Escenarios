name: Ejecutar JMeter en Windows
 
on:
  workflow_dispatch:
 
jobs:
  run-jmeter-windows:
    runs-on: windows-latest
 
    steps:
    - name: Checkout del repositorio
      uses: actions/checkout@v3
 
    - name: Descargar Apache JMeter 5.6.3
      run: |
        curl -LO https://downloads.apache.org/jmeter/binaries/apache-jmeter-5.6.3.zip
        tar -xf apache-jmeter-5.6.3.zip
 
    - name: Agregar JMeter al PATH
      run: |
        echo "$PWD\\apache-jmeter-5.6.3\\bin" >> $env:GITHUB_PATH
        echo "JMETER_HOME=$PWD\\apache-jmeter-5.6.3" >> $env:GITHUB_ENV
      shell: pwsh
 
    - name: Ejecutar BAT_PRUEBA.bat
      run: .\BAT_PRUEBA.bat . 1 5
      shell: cmd
 
    - name: Subir reportes como artefactos
      uses: actions/upload-artifact@v4
      with:
        name: reportes-jmeter-windows
        path: Escenario*/Dashboard
